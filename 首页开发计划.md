# 妙笔小伙伴 - 首页开发计划

## 项目概述
基于视觉稿实现"妙笔小伙伴"智能英语作文批改应用的移动端首页，提供作文上传、学习资料浏览等核心功能。

## 技术栈
- **前端框架**: React 18 + TypeScript
- **构建工具**: Vite
- **样式方案**: Tailwind CSS + Styled Components
- **状态管理**: Zustand
- **路由管理**: React Router DOM
- **动画效果**: Framer Motion
- **图标库**: Lucide React
- **相机功能**: 浏览器原生 getUserMedia API
- **图片上传**: ImgBB 免费图片托管服务
- **数据持久化**: localStorage + Zustand persist

## 页面结构设计

### 1. 整体布局
```
┌─────────────────────────┐
│         Header          │ ← 固定头部
├─────────────────────────┤
│                         │
│       Welcome Area      │ ← 欢迎区域
│                         │
├─────────────────────────┤
│     Upload Section      │ ← 上传区域
│                         │
├─────────────────────────┤
│  Learning Resources     │ ← 学习资料
│                         │
├─────────────────────────┤
│      Bottom Nav         │ ← 固定底部导航
└─────────────────────────┘
```

### 2. 组件架构
```
Home/
├── components/
│   ├── Header/
│   │   ├── Header.tsx
│   │   └── UserRoleSelector.tsx
│   ├── WelcomeSection/
│   │   ├── WelcomeSection.tsx
│   │   ├── UsageStats.tsx
│   │   └── FeatureHighlights.tsx
│   ├── UploadSection/
│   │   ├── UploadSection.tsx
│   │   ├── PhotoUploadCard.tsx
│   │   └── TextInputCard.tsx
│   ├── LearningResources/
│   │   ├── LearningResources.tsx
│   │   └── ResourceCard.tsx
│   └── BottomNavigation/
│       └── BottomNavigation.tsx
```

## 功能模块详细设计

### 1. Header 组件
**功能**: 应用标题、用户角色选择
**设计要点**:
- 左侧：应用标题 + 铅笔图标
- 右侧：用户角色选择（学生/其他）
- 高度：60px
- 背景：白色，带阴影

### 2. Welcome Section 组件
**功能**: 欢迎信息、使用统计、功能亮点
**设计要点**:
- 主标题：欢迎使用妙笔小伙伴
- 副标题：AI 助你写出好作文
- 插图：两个卡通儿童读书的插图
- 统计信息：
  - 今日剩余次数（5次）
  - 智能批改速度（3秒）
- 背景：白色渐变

### 3. Upload Section 组件
**功能**: 作文上传入口
**设计要点**:
- 标题：上传作文 + AI加持标签
- 两个上传卡片：
  - 拍照上传：支持手写体识别
  - 文本输入：支持复制粘贴
- 卡片设计：圆角、阴影、悬停效果

### 4. Learning Resources 组件
**功能**: 英语学习资料展示
**设计要点**:
- 标题：英语学习资料 + 查看全部
- 2x2网格布局：
  - 每日听力训练（蓝紫渐变）
  - 重点词汇记忆（绿色渐变）
  - 语法练习题库（紫色渐变）
  - 考试真题解析（橙色渐变）
- 每个卡片包含图标、标题、描述

### 5. Bottom Navigation 组件
**功能**: 底部导航栏
**设计要点**:
- 4个导航项：首页、作文、历史批改、优秀范文
- 当前页面高亮显示
- 固定底部，高度：60px

## 状态管理设计

### Store 结构
```typescript
interface AppState {
  // 用户信息
  user: {
    role: 'student' | 'teacher' | 'parent'
    remainingCount: number
    lastResetDate: string
  }
  
  // 学习资料
  learningResources: LearningResource[]
  
  // 上传历史
  uploadHistory: UploadRecord[]
  
  // 应用设置
  settings: {
    theme: 'light' | 'dark'
    language: 'zh' | 'en'
  }
}
```

### 数据持久化
- 用户信息：localStorage
- 上传历史：localStorage
- 学习资料：从API获取，缓存到sessionStorage

## 移动端优化策略

### 1. 响应式设计
- 主要针对手机端（375px - 414px）
- 使用rem单位，适配不同屏幕密度
- 触摸友好的按钮尺寸（最小44px）

### 2. 性能优化
- 图片懒加载
- 组件按需加载
- 防抖处理用户交互

### 3. 用户体验
- 流畅的滚动体验
- 防止iOS Safari橡皮筋效果
- 触摸反馈动画
- 加载状态提示

## ImgBB图片上传集成方案

### 服务选择
- **服务商**: ImgBB (https://imgbb.com)
- **免费额度**: 32MB/张，无总容量限制
- **优势**: 无需复杂配置，支持base64直接上传，返回公开URL

### 技术实现
```typescript
// 上传流程
1. 相机拍照 → base64数据
2. 调用ImgBB API → 上传图片
3. 获取公开URL → 用于AI解析
4. 保存到本地状态 → 历史记录
```

### 开发任务
- [ ] 注册ImgBB账号，获取API Key
- [ ] 创建图片上传服务模块
- [ ] 集成到相机组件
- [ ] 添加上传进度显示
- [ ] 实现错误处理和重试机制

### 代码实现示例
```typescript
// src/services/uploadService.ts
export const uploadImageToImgBB = async (base64Data: string): Promise<string> => {
  const formData = new FormData()
  formData.append('image', base64Data)
  formData.append('key', IMGBB_API_KEY)
  
  const response = await fetch('https://api.imgbb.com/1/upload', {
    method: 'POST',
    body: formData
  })
  
  const result = await response.json()
  if (result.success) {
    return result.data.url
  } else {
    throw new Error('上传失败')
  }
}
```

### 集成到相机组件
```typescript
// 在CameraModal.tsx中
const handlePhotoCapture = async (imageData: string) => {
  try {
    setUploading(true)
    const publicUrl = await uploadImageToImgBB(imageData)
    
    addUploadRecord({
      type: 'photo',
      content: publicUrl, // 存储公开URL
      status: 'completed'
    })
    
    showToast('照片上传成功！', 'success')
  } catch (error) {
    showToast('上传失败，请重试', 'error')
  } finally {
    setUploading(false)
  }
}
```

## 开发阶段规划

### Phase 1: 基础架构 (1-2天)
- [ ] 安装必要依赖包
- [ ] 设置Zustand状态管理
- [ ] 创建基础布局组件
- [ ] 实现移动端适配

### Phase 2: 核心组件 (2-3天)
- [ ] 实现Header组件
- [ ] 实现Welcome Section
- [ ] 实现Upload Section
- [ ] 实现Learning Resources

### Phase 3: 功能集成 (1-2天)
- [ ] 集成相机功能
- [ ] 集成ImgBB图片上传服务
- [ ] 实现数据持久化
- [ ] 添加动画效果
- [ ] 优化移动端体验

### Phase 4: 测试优化 (1天)
- [ ] 功能测试
- [ ] 性能优化
- [ ] 兼容性测试
- [ ] 代码重构

## 技术难点与解决方案

### 1. 相机功能集成
**难点**: 浏览器兼容性、权限处理
**解决方案**: 
- 使用getUserMedia API
- 添加权限检查和错误处理
- 提供降级方案（文件上传）

### 2. 图片上传服务
**难点**: 图片存储和公开访问
**解决方案**: 
- 使用ImgBB免费图片托管服务
- 支持base64直接上传
- 获取公开URL用于AI解析
- 添加上传进度和错误处理

### 3. 移动端滚动优化
**难点**: iOS Safari滚动卡顿
**解决方案**:
- 使用-webkit-overflow-scrolling: touch
- 避免在滚动容器上使用transform
- 合理使用will-change属性

### 4. 状态管理复杂度
**难点**: 多组件状态同步
**解决方案**:
- 使用Zustand的模块化设计
- 合理划分store边界
- 使用中间件处理副作用

## 验收标准

### 功能验收
- [ ] 所有UI组件按视觉稿实现
- [ ] 相机拍照功能正常工作
- [ ] 图片上传到ImgBB功能正常
- [ ] 数据持久化功能正常
- [ ] 移动端交互流畅

### 性能验收
- [ ] 首屏加载时间 < 2s
- [ ] 页面滚动帧率 > 55fps
- [ ] 内存使用合理

### 兼容性验收
- [ ] iOS Safari 14+
- [ ] Android Chrome 80+
- [ ] 微信内置浏览器

## 后续扩展计划

### 短期 (1-2周)
- 作文批改结果页面
- 历史记录管理
- 用户设置页面
- 图片上传进度优化
- 批量上传功能

### 中期 (1个月)
- 学习资料详情页
- 用户成长档案
- 社交分享功能
- 图片压缩和格式优化
- 多图片上传支持

### 长期 (3个月)
- AI批改算法优化
- 多语言支持
- 离线功能支持
- 自建图片存储服务
- 图片AI识别优化

---

**文档版本**: v1.0  
**创建时间**: 2024年12月  
**最后更新**: 2024年12月
